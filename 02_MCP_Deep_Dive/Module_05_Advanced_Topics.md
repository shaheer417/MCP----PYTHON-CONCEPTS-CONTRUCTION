# Module 05: Advanced Topics - Enterprise & Production Features

## Azure, OAuth2, Scaling, Security & Advanced Patterns (15 Sub-Topics!)

**Sources:**
- [Microsoft MCP for Beginners - Module 05](https://github.com/microsoft/mcp-for-beginners/tree/main/05-AdvancedTopics)

---

## ğŸ¯ The 15 Advanced Topics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          MODULE 05: ADVANCED TOPICS (15 LESSONS)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  CLOUD & INTEGRATION:                                       â”‚
â”‚  â”œâ”€ 5.1: Azure Integration                                  â”‚
â”‚  â”œâ”€ 5.13: Azure AI Foundry                                  â”‚
â”‚  â””â”€ 5.12: Entra ID Authentication                           â”‚
â”‚                                                             â”‚
â”‚  FEATURES:                                                  â”‚
â”‚  â”œâ”€ 5.2: Multi-modality (text, images, audio)               â”‚
â”‚  â”œâ”€ 5.4: Root Contexts                                      â”‚
â”‚  â”œâ”€ 5.5: Routing                                            â”‚
â”‚  â”œâ”€ 5.6: Sampling                                           â”‚
â”‚  â””â”€ 5.14: Context Engineering                               â”‚
â”‚                                                             â”‚
â”‚  SECURITY & AUTH:                                           â”‚
â”‚  â”œâ”€ 5.3: OAuth2 Implementation                              â”‚
â”‚  â””â”€ 5.8: Advanced Security                                  â”‚
â”‚                                                             â”‚
â”‚  PRODUCTION:                                                â”‚
â”‚  â”œâ”€ 5.7: Scaling Strategies                                 â”‚
â”‚  â”œâ”€ 5.10: Realtime Streaming                                â”‚
â”‚  â”œâ”€ 5.11: Realtime Search                                   â”‚
â”‚  â””â”€ 5.15: Custom Transport                                  â”‚
â”‚                                                             â”‚
â”‚  EXTERNAL INTEGRATION:                                      â”‚
â”‚  â””â”€ 5.9: Web Search Integration                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## â˜ï¸ Azure Integration

### **Azure Services for MCP**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AZURE MCP STACK                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Authentication:                                            â”‚
â”‚  â””â”€ Microsoft Entra ID (OAuth 2.1)                          â”‚
â”‚                                                             â”‚
â”‚  Hosting:                                                   â”‚
â”‚  â”œâ”€ Azure Container Apps (serverless containers)            â”‚
â”‚  â”œâ”€ Azure App Service (web apps)                            â”‚
â”‚  â””â”€ Azure Functions (serverless functions)                  â”‚
â”‚                                                             â”‚
â”‚  AI Services:                                               â”‚
â”‚  â”œâ”€ Azure OpenAI (GPT models)                               â”‚
â”‚  â”œâ”€ Azure AI Foundry (model deployment)                     â”‚
â”‚  â””â”€ Azure Content Safety (prompt shields)                   â”‚
â”‚                                                             â”‚
â”‚  Storage & Data:                                            â”‚
â”‚  â”œâ”€ Azure Cosmos DB (NoSQL)                                 â”‚
â”‚  â”œâ”€ Azure SQL Database                                      â”‚
â”‚  â””â”€ Azure Blob Storage (files)                              â”‚
â”‚                                                             â”‚
â”‚  Monitoring:                                                â”‚
â”‚  â”œâ”€ Application Insights (telemetry)                        â”‚
â”‚  â””â”€ Azure Monitor (alerts)                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” OAuth2 Implementation

### **OAuth 2.1 with PKCE Flow**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMPLETE OAUTH 2.1 + PKCE FLOW                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Step 1: Generate PKCE Values                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ code_verifier = random_string(128)                      â”‚           â”‚
â”‚  â”‚ code_challenge = base64url(SHA256(code_verifier))       â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                    â†“                                                    â”‚
â”‚  Step 2: Authorization Request                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ GET /authorize?                                         â”‚           â”‚
â”‚  â”‚   client_id=mcp-server-123                             â”‚           â”‚
â”‚  â”‚   &redirect_uri=https://server.com/callback            â”‚           â”‚
â”‚  â”‚   &response_type=code                                  â”‚           â”‚
â”‚  â”‚   &code_challenge=ABC123...                            â”‚           â”‚
â”‚  â”‚   &code_challenge_method=S256                          â”‚           â”‚
â”‚  â”‚   &scope=files.read files.write                        â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                    â†“                                                    â”‚
â”‚  Step 3: User Login & Consent                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ User enters credentials + MFA                           â”‚           â”‚
â”‚  â”‚ User approves scopes                                    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                    â†“                                                    â”‚
â”‚  Step 4: Authorization Code                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Redirect: https://server.com/callback?code=AUTH_CODE    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                    â†“                                                    â”‚
â”‚  Step 5: Token Exchange (with PKCE verification)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ POST /token                                             â”‚           â”‚
â”‚  â”‚ {                                                       â”‚           â”‚
â”‚  â”‚   grant_type: "authorization_code",                     â”‚           â”‚
â”‚  â”‚   code: "AUTH_CODE",                                    â”‚           â”‚
â”‚  â”‚   redirect_uri: "https://server.com/callback",          â”‚           â”‚
â”‚  â”‚   code_verifier: "original_random_string"               â”‚           â”‚
â”‚  â”‚ }                                                       â”‚           â”‚
â”‚  â”‚                                                        â”‚           â”‚
â”‚  â”‚ Auth server verifies:                                   â”‚           â”‚
â”‚  â”‚ âœ“ SHA256(code_verifier) == code_challenge              â”‚           â”‚
â”‚  â”‚                                                        â”‚           â”‚
â”‚  â”‚ Returns:                                                â”‚           â”‚
â”‚  â”‚ {                                                       â”‚           â”‚
â”‚  â”‚   access_token: "eyJ...",                               â”‚           â”‚
â”‚  â”‚   token_type: "Bearer",                                 â”‚           â”‚
â”‚  â”‚   expires_in: 3600,                                     â”‚           â”‚
â”‚  â”‚   refresh_token: "..."                                  â”‚           â”‚
â”‚  â”‚ }                                                       â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                    â†“                                                    â”‚
â”‚  Step 6: Authenticated Requests                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ All requests include:                                   â”‚           â”‚
â”‚  â”‚ Authorization: Bearer eyJ...                            â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scaling Strategies

### **Scaling Architecture**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SCALING PATTERNS                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  VERTICAL SCALING (Scale Up)                                â”‚
â”‚  â”œâ”€ More CPU/RAM for server                                 â”‚
â”‚  â”œâ”€ Handle more concurrent requests                         â”‚
â”‚  â””â”€ Good for: Single-server deployments                     â”‚
â”‚                                                             â”‚
â”‚  HORIZONTAL SCALING (Scale Out)                             â”‚
â”‚  â”œâ”€ Multiple server instances                               â”‚
â”‚  â”œâ”€ Load balancer distributes requests                      â”‚
â”‚  â””â”€ Good for: High availability                             â”‚
â”‚                                                             â”‚
â”‚  CACHING                                                    â”‚
â”‚  â”œâ”€ Cache tool results                                      â”‚
â”‚  â”œâ”€ Cache resource content                                  â”‚
â”‚  â””â”€ Reduces redundant operations                            â”‚
â”‚                                                             â”‚
â”‚  ASYNC PROCESSING                                           â”‚
â”‚  â”œâ”€ Use asyncio/async-await                                 â”‚
â”‚  â”œâ”€ Non-blocking I/O                                        â”‚
â”‚  â””â”€ Handle multiple requests concurrently                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Sources

- [Module 05: Advanced Topics](https://github.com/microsoft/mcp-for-beginners/tree/main/05-AdvancedTopics)

---

## âœ… Key Takeaways

```
15 ADVANCED TOPICS COVERED:
â€¢ Azure cloud integration
â€¢ OAuth2 + PKCE authentication
â€¢ Multi-modality support
â€¢ Scaling for production
â€¢ Real-time streaming
â€¢ Custom transports
```

---

**Next: Module 06 - Community!** ğŸš€
